services:
  portal-agro-api-staging:
    container_name: portal-agro-api-staging
    build:
      context: ../../../                # ← raíz del repo
      dockerfile: Portal-Agro-comercial-del-Huila/Web/Dockerfile
    image: portal-agro-api-staging:latest
    restart: always
    environment:
      # ===== SMTP / Gmail =====
      - CONFIG_EMAIL__EMAIL=portalagrocomercialhuila@gmail.com
      - CONFIG_EMAIL__HOST=smtp.gmail.com
      - CONFIG_EMAIL__PORT=587
      # ATENCIÓN: las contraseñas de app de Google se usan SIN espacios
      - CONFIG_EMAIL__PASSWORD=qtckwqqwgnmarosr
      # 587 => STARTTLS
      - CONFIG_EMAIL__USESTARTTLS=true
      - CONFIG_EMAIL__USESSL=false
    env_file:
      - .env
    ports:
      - "5102:8080"
    networks:
      - portal-agro_network
    labels:
      - com.portalagro.environment=staging

networks:
  portal-agro_network:
    external: true
